// DO NOT EDIT: File is generated by code generator.
using System;
using System.Net;
using System.Net.Http;
using NUnit.Framework;
using System.Threading.Tasks;
using System.Collections.Generic;

using PokepayPartnerCsharpSdk;

namespace PokepayPartnerCsharpSdk.Test
{
    public class RegisterBankAccount
    {
        private Client client;

        [OneTimeSetUp]
        public void OneTimeSetup()
        {
            client = new Client("~/.pokepay/test-config.ini");
        }

        [Test]
        public async Task testRegisterBankAccount()
        {
            string customer_name = "customer-name" + Util.RandomString(6);
            string account_name = "account-name" + Util.RandomString(6);
            Response.AccountWithUser customer = await new Request.CreateCustomerAccount(
                "4b138a4c-8944-4f98-a5c4-96d3c1c415eb"
            ) {

                UserName = customer_name,
                AccountName = account_name,}
            .Send(client);
            string user_device_metadata = "{\"user_agent\": \"Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:120.0) Gecko/20100101 Firefox/120.0\"}";
            Response.UserDevice user_device = await new Request.CreateUserDevice(
                customer.User.Id
            ) {

                Metadata = user_device_metadata,}
            .Send(client);
            Response.UserDevice get_user_device_response = await new Request.GetUserDevice(
                user_device.Id
            ).Send(client);
            Assert.AreEqual(get_user_device_response.IsActive, false);
            Response.UserDevice user_device_activated = await new Request.ActivateUserDevice(
                get_user_device_response.Id
            ).Send(client);
            Assert.AreEqual(user_device_activated.IsActive, true);
            Response.BankRegisteringInfo create_bank = await new Request.CreateBank(
                get_user_device_response.Id,
                "4b138a4c-8944-4f98-a5c4-96d3c1c415eb",
                "dummy",
                "ポケペイタロウ"
            ).Send(client);
            Response.Banks bank_accounts_listed = await new Request.ListBanks(
                get_user_device_response.Id
            ).Send(client);
            Assert.AreEqual(bank_accounts_listed.Count, 0);
        }
    }
}
